# ğŸ Frigate Apple Siliconæ’ä»¶

[English](README.md) | ç®€ä½“ä¸­æ–‡

ä¸€é”®éƒ¨ç½²æ”¯æŒApple Neural EngineåŠ é€Ÿçš„Frigate NVRç³»ç»Ÿ

## âœ¨ ç‰¹æ€§

- ğŸš€ **ç¥ç»å¼•æ“åŠ é€Ÿ** - åˆ©ç”¨Apple Siliconçš„AIèŠ¯ç‰‡è¿›è¡Œå®æ—¶ç‰©ä½“æ£€æµ‹
- ğŸ³ **Dockeréƒ¨ç½²** - Frigateä¸»æœåŠ¡è¿è¡Œåœ¨Dockerå®¹å™¨ä¸­
- ğŸ”Œ **å³æ’å³ç”¨** - è‡ªåŠ¨åŒ–å®‰è£…è„šæœ¬ï¼Œ5åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²
- âš¡ **é«˜æ€§èƒ½** - æ£€æµ‹é€Ÿåº¦å¯è¾¾60 FPSï¼Œä¸Google Coral TPUç›¸å½“
- ğŸ¯ **ä½åŠŸè€—** - Neural EngineåŠŸè€—ä»…3-5Wï¼Œæ¯”GPUçœç”µ80%

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

| é¡¹ç›® | è¦æ±‚ |
|------|------|
| æ“ä½œç³»ç»Ÿ | macOS 12.0 (Monterey) æˆ–æ›´é«˜ |
| èŠ¯ç‰‡ | Apple Silicon (M1/M2/M3/M4) |
| å†…å­˜ | 8GBï¼ˆæ¨è16GBï¼‰ |
| å­˜å‚¨ | 20GBå¯ç”¨ç©ºé—´ï¼ˆå–å†³äºå½•åƒè®¾ç½®ï¼‰ |
| è½¯ä»¶ | Docker Desktop, Python 3.9+ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬1æ­¥ï¼šä¸‹è½½æ’ä»¶

```bash
# å¦‚æœå·²æœ‰frigate-setup-wizardé¡¹ç›®
cd frigate-setup-wizard/apple-silicon-plugin

# æˆ–å•ç‹¬ä¸‹è½½
git clone https://github.com/ä½ çš„ç”¨æˆ·å/frigate-apple-silicon-plugin.git
cd frigate-apple-silicon-plugin
```

### ç¬¬2æ­¥ï¼šè¿è¡Œå®‰è£…

```bash
./install.sh
```

å®‰è£…è¿‡ç¨‹çº¦éœ€2-3åˆ†é’Ÿï¼Œè„šæœ¬ä¼šï¼š
- âœ… è‡ªåŠ¨æ£€æŸ¥ç³»ç»Ÿç¯å¢ƒ
- âœ… å®‰è£…Pythonä¾èµ–åŒ…
- âœ… åˆ›å»ºå¿…è¦çš„ç›®å½•
- âœ… ç”Ÿæˆå¯åŠ¨è„šæœ¬

### ç¬¬3æ­¥ï¼šé…ç½®æ‘„åƒå¤´

ç¼–è¾‘ `config/config.yml`ï¼Œæ·»åŠ ä½ çš„æ‘„åƒå¤´ï¼š

```yaml
cameras:
  å‰é—¨:  # æ‘„åƒå¤´åç§°ï¼ˆå¯ä»¥ç”¨ä¸­æ–‡ï¼‰
    enabled: True
    ffmpeg:
      inputs:
        - path: rtsp://ç”¨æˆ·å:å¯†ç @192.168.1.100:554/stream
          roles:
            - detect    # å¯ç”¨æ£€æµ‹
            - record    # å¯ç”¨å½•åƒ
    detect:
      enabled: True
      width: 1280
      height: 720
      fps: 5            # æ£€æµ‹å¸§ç‡
    objects:
      track:            # è¦æ£€æµ‹çš„ç‰©ä½“
        - person        # äºº
        - car           # æ±½è½¦
        - dog           # ç‹—
        - cat           # çŒ«
```

### ç¬¬4æ­¥ï¼šå¯åŠ¨æœåŠ¡

```bash
./start-all.sh
```

å¯åŠ¨åè®¿é—®ï¼š
- ğŸŒ Webç•Œé¢: http://localhost:5000
- ğŸ“¹ å®æ—¶ç”»é¢ã€äº‹ä»¶å›æ”¾ã€å½•åƒç®¡ç†

### ç¬¬5æ­¥ï¼šåœæ­¢æœåŠ¡

```bash
./stop-all.sh
```

## ğŸ¬ ä½¿ç”¨æ¼”ç¤º

### 1. å®æ—¶æ£€æµ‹
æ‰“å¼€Webç•Œé¢åï¼Œå¯ä»¥çœ‹åˆ°ï¼š
- å®æ—¶æ‘„åƒå¤´ç”»é¢
- æ£€æµ‹åˆ°çš„ç‰©ä½“ï¼ˆè¾¹ç•Œæ¡†+æ ‡ç­¾ï¼‰
- FPSå’Œå»¶è¿Ÿä¿¡æ¯

### 2. äº‹ä»¶æŸ¥çœ‹
- ç‚¹å‡»"äº‹ä»¶"æ ‡ç­¾æŸ¥çœ‹æ£€æµ‹å†å²
- è¿‡æ»¤ç‰¹å®šç‰©ä½“ç±»å‹ï¼ˆäººã€è½¦ç­‰ï¼‰
- æŸ¥çœ‹å¿«ç…§å’Œå½•åƒç‰‡æ®µ

### 3. æ€§èƒ½ç›‘æ§
- ç³»ç»Ÿè´Ÿè½½
- æ£€æµ‹å™¨æ€§èƒ½ï¼ˆFPSã€æ¨ç†æ—¶é—´ï¼‰
- å­˜å‚¨ä½¿ç”¨æƒ…å†µ

## ğŸ”§ é«˜çº§é…ç½®

### æ£€æµ‹åŒºåŸŸè®¾ç½®

åªåœ¨ç‰¹å®šåŒºåŸŸæ£€æµ‹ç‰©ä½“ï¼ˆå‡å°‘è¯¯æŠ¥ï¼‰ï¼š

```yaml
cameras:
  å‰é—¨:
    zones:
      è½¦é“:  # åŒºåŸŸåç§°
        coordinates: 0,0,1920,0,1920,1080,0,1080  # åæ ‡
        objects:
          - person
          - car
      è‰åª:
        coordinates: 500,500,1400,500,1400,1000,500,1000
        objects:
          - person
```

### å½•åƒè®¾ç½®

```yaml
record:
  enabled: True
  retain:
    days: 7          # ä¿ç•™7å¤©å½•åƒ
    mode: motion     # ä»…åœ¨æœ‰è¿åŠ¨æ—¶å½•åƒ
  events:
    retain:
      default: 14    # äº‹ä»¶ä¿ç•™14å¤©
```

### é€šçŸ¥è®¾ç½®

é…åˆHome Assistantæˆ–å…¶ä»–æ™ºèƒ½å®¶å±…ç³»ç»Ÿï¼š

```yaml
mqtt:
  host: ä½ çš„MQTTæœåŠ¡å™¨
  port: 1883
  user: mqttç”¨æˆ·å
  password: mqttå¯†ç 
```

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

### æ£€æµ‹é€Ÿåº¦ (YOLOv7-320æ¨¡å‹)

| å¹³å° | FPS | å»¶è¿Ÿ |
|------|-----|------|
| Apple M3 Neural Engine | 80 | 12.5ms |
| Apple M2 Neural Engine | 70 | 14.3ms |
| Apple M1 Neural Engine | 60 | 16.7ms |
| Google Coral TPU | 60 | 16.7ms |
| Mac M1 CPU | 2 | 500ms |

### åŠŸè€—å¯¹æ¯”

| æ–¹æ¡ˆ | åŠŸè€— | æ¯æ—¥è€—ç”µ |
|------|------|---------|
| Neural Engine | 3-5W | 0.07-0.12 åº¦ |
| Mac CPU | 20W+ | 0.48 åº¦ |
| NVIDIA GPU | 30-200W | 0.72-4.8 åº¦ |
| Google Coral | 2W | 0.05 åº¦ |

## ğŸ› å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆæ£€æµ‹å™¨ä¸èƒ½åœ¨Dockeré‡Œè¿è¡Œï¼Ÿ

**A:** Apple Siliconçš„Neural Engineåªèƒ½é€šè¿‡macOSåŸç”Ÿæ¡†æ¶(CoreML)è®¿é—®ï¼ŒDockerå®¹å™¨æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬çš„æ–¹æ¡ˆæ˜¯ï¼š
- Frigateåœ¨Dockerä¸­è¿è¡Œï¼ˆç®¡ç†å½•åƒã€Webç•Œé¢ï¼‰
- æ£€æµ‹å™¨åœ¨macOSä¸»æœºè¿è¡Œï¼ˆä½¿ç”¨Neural Engineï¼‰
- ä¸¤è€…é€šè¿‡ZMQç½‘ç»œé€šä¿¡

### Q: æ€§èƒ½çœŸçš„å’ŒCoral TPUä¸€æ ·å¿«å—ï¼Ÿ

**A:** æ˜¯çš„ï¼æ ¹æ®å®é™…æµ‹è¯•ï¼š
- M1: ~60 FPS
- M2: ~70 FPS
- M3: ~80 FPS
- Coral TPU: ~60 FPS

M2/M3ç”šè‡³æ¯”Coralæ›´å¿«ï¼Œè€Œä¸”æ— éœ€é¢å¤–ç¡¬ä»¶ã€‚

### Q: æ£€æµ‹å™¨å´©æºƒæ€ä¹ˆåŠï¼Ÿ

**A:** æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼Œå¸¸è§åŸå› ï¼š
1. **æ¨¡å‹æ–‡ä»¶ç¼ºå¤±** - ç¡®ä¿ONNXæ¨¡å‹åœ¨ `detector/models/` ç›®å½•
2. **ä¾èµ–æœªå®‰è£…** - é‡æ–°è¿è¡Œ `pip3 install -r requirements.txt`
3. **ç«¯å£è¢«å ç”¨** - æ£€æŸ¥5555ç«¯å£æ˜¯å¦è¢«å…¶ä»–ç¨‹åºä½¿ç”¨

### Q: å¦‚ä½•æŸ¥çœ‹æ—¥å¿—ï¼Ÿ

**A:**
```bash
# Frigateæ—¥å¿—
docker logs frigate -f

# æ£€æµ‹å™¨æ—¥å¿—
# æ£€æµ‹å™¨è¿è¡Œçš„ç»ˆç«¯çª—å£ä¼šç›´æ¥æ˜¾ç¤º

# MQTTæ—¥å¿—
docker logs frigate-mqtt -f
```

### Q: æ”¯æŒå“ªäº›æ£€æµ‹æ¨¡å‹ï¼Ÿ

**A:** æ”¯æŒä»»ä½•ONNXæ ¼å¼çš„ç‰©ä½“æ£€æµ‹æ¨¡å‹ï¼š
- YOLOv5/v7/v8/v9
- SSD MobileNet
- RF-DETR
- D-FINE
- è‡ªå®šä¹‰æ¨¡å‹

åªéœ€è½¬æ¢ä¸ºONNXæ ¼å¼å¹¶é…ç½®å³å¯ã€‚

### Q: å¯ä»¥æ£€æµ‹å“ªäº›ç‰©ä½“ï¼Ÿ

**A:** é»˜è®¤æ”¯æŒ80ç§COCOæ•°æ®é›†ç‰©ä½“ï¼š
- äººç‰©ï¼špersonï¼ˆäººï¼‰
- åŠ¨ç‰©ï¼šdogï¼ˆç‹—ï¼‰ã€catï¼ˆçŒ«ï¼‰ã€birdï¼ˆé¸Ÿï¼‰ã€horseï¼ˆé©¬ï¼‰ç­‰
- è½¦è¾†ï¼šcarï¼ˆæ±½è½¦ï¼‰ã€motorcycleï¼ˆæ‘©æ‰˜è½¦ï¼‰ã€busï¼ˆå…¬äº¤ï¼‰ã€truckï¼ˆå¡è½¦ï¼‰
- ç‰©å“ï¼šbackpackï¼ˆèƒŒåŒ…ï¼‰ã€handbagï¼ˆæ‰‹æåŒ…ï¼‰ã€suitcaseï¼ˆè¡Œæç®±ï¼‰ç­‰

å®Œæ•´åˆ—è¡¨è§ `detector/config.yml`

### Q: éœ€è¦ä»€ä¹ˆæ ·çš„æ‘„åƒå¤´ï¼Ÿ

**A:** åªè¦æ”¯æŒRTSPåè®®çš„ç½‘ç»œæ‘„åƒå¤´éƒ½å¯ä»¥ï¼š
- æµ·åº·å¨è§†ï¼ˆHikvisionï¼‰
- å¤§åï¼ˆDahuaï¼‰
- TP-Linkã€å°ç±³ç­‰æ¶ˆè´¹çº§å“ç‰Œ
- ä»»ä½•æ”¯æŒONVIFåè®®çš„æ‘„åƒå¤´

### Q: å½•åƒå ç”¨å¤šå°‘ç©ºé—´ï¼Ÿ

**A:** å–å†³äºï¼š
- æ‘„åƒå¤´æ•°é‡
- åˆ†è¾¨ç‡ï¼ˆ1080pæ¯”720på ç”¨å¤šï¼‰
- å½•åƒæ¨¡å¼ï¼ˆè¿ç»­å½•åƒ vs è¿åŠ¨æ£€æµ‹ï¼‰
- ä¿ç•™æ—¶é—´

ç¤ºä¾‹ï¼š
- 1ä¸ª1080pæ‘„åƒå¤´ï¼Œ24å°æ—¶å½•åƒï¼šçº¦5-10GB/å¤©
- 4ä¸ª1080pæ‘„åƒå¤´ï¼Œè¿åŠ¨æ£€æµ‹å½•åƒï¼šçº¦10-20GB/å¤©

## ğŸ“ ç›®å½•è¯´æ˜

```
apple-silicon-plugin/
â”œâ”€â”€ install.sh              # å®‰è£…è„šæœ¬
â”œâ”€â”€ start-all.sh           # å¯åŠ¨æ‰€æœ‰æœåŠ¡
â”œâ”€â”€ stop-all.sh            # åœæ­¢æ‰€æœ‰æœåŠ¡
â”œâ”€â”€ start-detector.sh      # å•ç‹¬å¯åŠ¨æ£€æµ‹å™¨
â”œâ”€â”€ docker-compose.yml     # Dockeré…ç½®
â”‚
â”œâ”€â”€ detector/              # æ£€æµ‹å™¨æœåŠ¡ç›®å½•
â”‚   â”œâ”€â”€ detector.py        # æ£€æµ‹å™¨ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ config.yml         # æ£€æµ‹å™¨é…ç½®
â”‚   â”œâ”€â”€ requirements.txt   # Pythonä¾èµ–
â”‚   â””â”€â”€ models/            # æ¨¡å‹æ–‡ä»¶å­˜æ”¾å¤„
â”‚       â””â”€â”€ (æ”¾ONNXæ¨¡å‹)
â”‚
â”œâ”€â”€ config/                # Frigateé…ç½®ç›®å½•
â”‚   â”œâ”€â”€ config.yml         # ä¸»é…ç½®æ–‡ä»¶ï¼ˆç¼–è¾‘æ­¤æ–‡ä»¶ï¼‰
â”‚   â””â”€â”€ model_cache/       # æ¨¡å‹ç¼“å­˜
â”‚
â”œâ”€â”€ media/                 # å½•åƒå’Œå¿«ç…§
â”‚   â”œâ”€â”€ recordings/        # å½•åƒæ–‡ä»¶
â”‚   â””â”€â”€ snapshots/         # å¿«ç…§å›¾ç‰‡
â”‚
â””â”€â”€ mosquitto/             # MQTTæœåŠ¡
    â”œâ”€â”€ config/            # MQTTé…ç½®
    â”œâ”€â”€ data/              # MQTTæ•°æ®
    â””â”€â”€ log/               # MQTTæ—¥å¿—
```

## ğŸ”„ æ›´æ–°å‡çº§

### æ›´æ–°Frigateåˆ°æœ€æ–°ç‰ˆ

```bash
docker pull ghcr.io/blakeblackshear/frigate:stable
./stop-all.sh
./start-all.sh
```

### æ›´æ–°æ£€æµ‹å™¨

```bash
cd detector
pip3 install --upgrade -r requirements.txt
```

## ğŸ›¡ï¸ éšç§å’Œå®‰å…¨

- âœ… **æœ¬åœ°è¿è¡Œ** - æ‰€æœ‰æ•°æ®éƒ½åœ¨ä½ çš„Macä¸Šï¼Œä¸ä¸Šä¼ äº‘ç«¯
- âœ… **RTSPåŠ å¯†** - æ”¯æŒRTSPSåŠ å¯†ä¼ è¾“
- âœ… **è®¿é—®æ§åˆ¶** - å¯é…ç½®Webç•Œé¢å¯†ç 
- âœ… **éš”ç¦»ç½‘ç»œ** - æ‘„åƒå¤´å¯æ”¾åœ¨éš”ç¦»VLAN

## ğŸ“ è·å–å¸®åŠ©

- ğŸ“– [Frigateä¸­æ–‡æ–‡æ¡£](https://docs.frigate.video/)
- ğŸ’¬ [GitHub Discussions](https://github.com/blakeblackshear/frigate/discussions)
- ğŸ› [æŠ¥å‘Šé—®é¢˜](https://github.com/SunvidWong/frigate-setup-wizard/issues)
- ğŸ“§ Email: your-email@example.com

## ğŸ™ é¸£è°¢

- [Frigate NVR](https://frigate.video/) - Blake Blackshear
- [ONNX Runtime](https://onnxruntime.ai/) - Microsoft
- Apple CoreMLå›¢é˜Ÿ

## ğŸ“„ å¼€æºåè®®

MIT License

---

**ç”¨Apple Siliconæ‰“é€ ä½ çš„æ™ºèƒ½ç›‘æ§ç³»ç»Ÿï¼** ğŸš€ğŸ‡¨ğŸ‡³
